let searchFrameActive=0;function searchFrameOnClick(e){let search_frame=document.getElementsByClassName("search-frame"),slider=document.getElementById("slider");for(let i=0;i<search_frame.length;i++)search_frame[i].onclick=function(e){var left=addRippleEffect(e,this,"rgba(30, 144, 255, .15)");if(searchFrameActive<0||i===searchFrameActive)return;let width=this.getBoundingClientRect().width;this.style.color="var(--general-final-color)",search_frame[searchFrameActive].style.color="gray",slider.style.width=width+"px",slider.style.left=left-vue.frame.first_left+"px";let searchResultList=document.getElementsByClassName("search-result-list");searchResultList[searchFrameActive].style.width="0",searchResultList[searchFrameActive].style.opacity="0",searchResultList[i].style.width="100%",searchResultList[i].style.opacity="1",searchResultList[i].style.display="block",searchResultList[searchFrameActive].style.display="none",searchFrameActive=i}}function dragFrame(e,name){let slider=document.getElementById("slider"),list=document.getElementsByClassName(name),width=3*list[0].getBoundingClientRect().width/4;for(var i=0;i<list.length;i++)list[i].onmousedown=function(e){for(var j=0;0<list.length&&0===width;i++)width=3*list[0].getBoundingClientRect().width/4;let listObj=this,disX=e.clientX-this.offsetLeft,move=null;document.onmousemove=function(e){if(move=e.clientX-disX,move>0||Math.abs(move)>width)return;listObj.style.left=move+"px";let sliderLeft=slider.getBoundingClientRect().left+move;slider.style.left=sliderLeft+"px"},document.onmouseup=function(){document.onmousemove=null,listObj.onmouseup=null,flag?autoSlider(slider,"frame",vue.frame.frameActive):autoSlider(slider,"search-frame",searchFrameActive)}}}let flag=!0;function autoSlider(slider,name,active){let li_list,left=document.getElementsByClassName(name)[active].getBoundingClientRect().left;slider.style.left=""+left-vue.frame.first_left+"px"}function leftSearchOnClick(){let leftSearch=document.getElementById("left-search"),settingBtn=document.getElementById("setting-btn"),searchCloseBtn=document.getElementById("search-close-btn"),contactList=document.getElementsByClassName("contact-list"),searchResultList=document.getElementsByClassName("search-result-list");leftSearch.onfocus=function(){let list,searchList;settingBtn.style.height="0",searchCloseBtn.style.height="45px",settingBtn.style.opacity="0",searchCloseBtn.style.opacity="1",document.getElementsByClassName("list")[0].classList.add("unactive"),document.getElementsByClassName("search-list")[0].classList.remove("unactive"),contactList[vue.frame.frameActive].style.width="0",contactList[vue.frame.frameActive].style.opacity="0",contactList[vue.frame.frameActive].style.display="none",searchResultList[searchFrameActive].style.width="100%",searchResultList[searchFrameActive].style.opacity="1",searchResultList[searchFrameActive].style.display="block";let search_frame=document.getElementsByClassName("search-frame"),slider=document.getElementById("slider");slider.style.width=search_frame[0].getBoundingClientRect().width+"px",autoSlider(slider,"search-frame",searchFrameActive),flag=!1},searchCloseBtn.onclick=function(){let list,searchList;vue.clearSearch(),settingBtn.style.height="45px",searchCloseBtn.style.height="0",settingBtn.style.opacity="1",searchCloseBtn.style.opacity="0",document.getElementsByClassName("list")[0].classList.remove("unactive"),document.getElementsByClassName("search-list")[0].classList.add("unactive"),searchResultList[searchFrameActive].style.width="0",searchResultList[searchFrameActive].style.opacity="0",searchResultList[searchFrameActive].style.display="none",contactList[vue.frame.frameActive].style.width="100%",contactList[vue.frame.frameActive].style.opacity="1",contactList[vue.frame.frameActive].style.display="block";let li_list=document.getElementsByClassName("frame"),slider=document.getElementById("slider");slider.style.width=li_list[0].getBoundingClientRect().width+"px",autoSlider(slider,"frame",vue.frame.frameActive),flag=!0}}let rightInfoShrink=!0;function rightInfoChange(rightInfo){let rightClose=document.getElementsByClassName("right-close")[0];rightClose.onclick=function(){rightInfoShrink?(rightClose.style.transform="rotate(180deg)",rightInfo.style.width="0",rightInfo.style.opacity="0",rightInfoShrink=!1):(rightClose.style.transform="",rightInfo.style.width="100%",rightInfo.style.opacity="1",rightInfoShrink=!0),reSizeEmojiWidth()}}function allRiff(){let riffAnimation=document.getElementsByClassName("riff");for(var i=0;i<riffAnimation.length;i++)riffAnimation[i].onclick=function(e){addRippleEffect(e,this,"rgba(120,120,120,.25)")}}function leftNavShrink(e){let searchRightShrink=!0,searchRight=document.getElementsByClassName("search-right")[0],leftNavExpand=document.getElementsByClassName("left-nav-expand")[0];searchRight.onclick=function(e){if(-1===vue.contactSelect.contactActive)return;let leftNav=document.getElementsByClassName("left-nav")[0];addRippleEffect(e,this,"rgba(30, 144, 255, .15)"),searchRightShrink&&(leftNav.style.width="0",searchRightShrink=!1,leftNavExpand.style.opacity="1"),setTimeout(()=>{reSizeEmojiWidth(),activeLeft=document.getElementById("emoji-list-active").getBoundingClientRect().left},500)},leftNavExpand.onclick=function(e){if(-1===vue.contactSelect.contactActive)return;let leftNav=document.getElementsByClassName("left-nav")[0];addRippleEffect(e,this,"rgba(30, 144, 255, .15)"),searchRightShrink||(leftNav.style.width="384px",searchRightShrink=!0,leftNavExpand.style.opacity="0"),activeLeft=originLeft,reSizeEmojiWidth()}}function sleep(n){for(var start=(new Date).getTime();!((new Date).getTime()-start>n););}function statisticsExpand(e){let statisticsItems=document.getElementsByClassName("statistics-items"),ordinary=document.getElementsByClassName("ordinary")[0],statisticsInfo=document.getElementsByClassName("statistics-info"),statisticsClose=document.getElementsByClassName("statistics-close-icon");for(var i=0;i<statisticsItems.length;i++)statisticsItems[i].onclick=function(){for(var j=0;j<statisticsItems.length&&this!==statisticsItems[j];j++);ordinary.style.width="0",ordinary.style.opacity="0",statisticsInfo[j].style.width="100%",statisticsInfo[j].style.opacity="1",statisticsActive=j};for(var i=0;i<statisticsClose.length;i++)statisticsClose[i].onclick=function(){this.parentElement.parentElement.style.width="0",this.parentElement.parentElement.style.opacity="0",ordinary.style.width="100%",ordinary.style.opacity="1",statisticsActive=-1}}let isHidden=!0;function onLoadHidden(){let settingBtn=document.getElementById("setting-btn"),hidden=document.getElementById("hidden"),height=35.2*document.getElementsByClassName("hidden-items").length+16;settingBtn.onclick=function(){isHidden?(settingBtn.style.transform="rotate(180deg)",settingBtn.style.opacity="0",hidden.style.height=height+"px",settingBtn.innerHTML="<ion-icon name='close-outline'></ion-icon>",settingBtn.style.opacity="1",isHidden=!1):(settingBtn.style.transform="rotate(0deg)",settingBtn.innerHTML="<ion-icon name='ellipsis-vertical-outline'></ion-icon>",hidden.style.height="0",isHidden=!0)}}function userSetting(){let hiddenItems=document.getElementsByClassName("hidden-items"),hidden=document.getElementById("hidden"),leftNavMain=document.getElementById("left-nav-main"),userSetting=document.getElementById("user-setting");for(let i=1;i<hiddenItems.length;i++)hiddenItems[i].onclick=function(){leftNavMain.style.width="0",leftNavMain.style.opacity="0",hidden.style.height="0",isHidden=!0,userSetting.style.width="384px",userSetting.style.opacity="1"};let hiddenHeadClose=document.getElementsByClassName("hidden-head-close");for(let i=0;i<hiddenHeadClose.length;i++)hiddenHeadClose[i].onclick=function(){leftNavMain.style.width="384px",leftNavMain.style.opacity="1",userSetting.style.width="0",userSetting.style.opacity="0";let settingBtn=document.getElementById("setting-btn"),hidden=document.getElementById("hidden");settingBtn.style.transform="rotate(0deg)",settingBtn.innerHTML="<ion-icon name='ellipsis-vertical-outline'></ion-icon>",hidden.style.height="0",isHidden=!0}}function editUserInfo(){let userSettingInfoItems=document.getElementsByClassName("user-setting-info-items"),userSettingHidden=document.getElementsByClassName("user-setting-hidden"),userSetting=document.getElementById("user-setting");for(let i=0;i<userSettingInfoItems.length-1;i++)userSettingInfoItems[i].onclick=function(){let j;for(j=0;j<userSettingInfoItems.length-1&&this!==userSettingInfoItems[j];j++);userSettingHidden[j].style.width="384px",userSettingHidden[j].style.opacity="1",userSetting.style.width="0",userSetting.style.opacity="0"};let userSettingClose=document.getElementsByClassName("user-setting-close");for(let i=0;i<userSettingClose.length;i++)userSettingClose[i].onclick=function(){let j;for(j=0;j<userSettingClose.length&&this!==userSettingClose[j];j++);userSetting.style.width="384px",userSetting.style.opacity="1",userSettingHidden[j].style.width="0",userSettingHidden[j].style.opacity="0"}}function scrollToBottom(){$("#chat-main")[0].scrollTop=$("#chat-main")[0].scrollHeight}function SystemEmoji(){$(".emoji-icon").click((function(e){e.preventDefault();let myField=document.getElementById("editor"),str=$(this).text();if(myField.selectionStart||"0"==myField.selectionStart){var startPos=myField.selectionStart,endPos=myField.selectionEnd,restoreTop=myField.scrollTop;myField.value=myField.value.substring(0,startPos)+str+myField.value.substring(endPos,myField.value.length),restoreTop>0&&(myField.scrollTop=restoreTop),myField.focus(),myField.selectionStart=startPos+str.length,myField.selectionEnd=startPos+str.length}else myField.value+=str,myField.focus()}))}window.onload=function(e){let rightInfo=document.getElementsByClassName("right-info")[0];searchFrameOnClick(e),allRiff(),rightInfoChange(rightInfo),leftNavShrink(e),statisticsExpand(e),onLoadHidden(),userSetting(),editUserInfo(),dragFrame(e,"list"),leftSearchOnClick(),darkModel(),SystemEmoji()};let emojiShow=!1,originLeft;function onLoadChatMain(){if(-1===vue.contactSelect.contactActive)return;let chatMain=document.getElementById("chat-main"),bodyHeight=window.innerHeight?window.innerHeight:document.documentElement&&document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.offsetHeight,emotionHeight=emojiShow?144:0;chatMain.style.height=bodyHeight-136-emotionHeight+"px",chatMain.style.width="100%"}function darkModel(){let darkModel=document.getElementById("darkModel"),flag=!0;darkModel.onclick=function(){let dark=document.getElementById("dark");flag?(dark.style.left="20px",$("#app").addClass("night"),flag=!1):(dark.style.left="-2px",$("#app").removeClass("night"),flag=!0)}}function reSizeEmojiWidth(){let width=$(".middle-chat").width(),timeId=setInterval(()=>{let tempWidth;$(".middle-chat").width()!==width?$(".emoji").css("width",width+"px"):clearInterval(timeId)},1)}document.getElementById("emotion").onclick=function(e){reSizeEmojiWidth();let emojiSelect=document.getElementsByClassName("emoji-list")[0],currentLeft=emojiSelect.getBoundingClientRect().left,currentWidth=emojiSelect.getBoundingClientRect().width;$("#emoji-list-active").css({width:currentWidth+"px",left:currentLeft-activeLeft+"px"}),$(".emoji-container:first-child").css("width","100%"),addRippleEffect(e,this,"rgba(30, 144, 255, .15)"),emojiShow?$("#emoji").css("height","0rem"):($(".emoji-container").css({width:"0"}),$(".emoji-container:eq(0)").css({width:"100%"}),$(".emoji-list:eq(0)").css({color:"var(--emoji-classify-selected-font-color)"}),emojiActive=0,$("#emoji").css("height","10rem")),emojiShow=!emojiShow,onLoadChatMain()},window.onresize=onLoadChatMain,$(document).ready((function(){activeLeft=document.getElementById("emoji-list-active").getBoundingClientRect().left,originLeft=activeLeft}));