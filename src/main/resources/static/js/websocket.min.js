function connectWebSocket(){const target="ws://localhost:8080/chat";return"WebSocket"in window?websocket=new WebSocket(target):alert("Not support websocket"),websocket.onerror=function(){setMessageInnerHTML("error");let time=[],timeId=setInterval(()=>{if(connectWebSocket(),time.push(timeId),1===websocket.readyState)for(let item of time)clearInterval(item)},500)},websocket.onopen=function(event){setMessageInnerHTML("Loc MSG: 建立连接")},websocket.onmessage=function(event){let message=event.data;vue.putMessage(message),setTimeout(()=>{scrollToBottom()},200)},websocket.onclose=function(){setMessageInnerHTML("Loc MSG:关闭连接")},window.onbeforeunload=function(){websocket.close()},websocket.readyState}function setMessageInnerHTML(innerHTML){console.log(innerHTML)}function closeWebSocket(){websocket.close()}connectWebSocket();