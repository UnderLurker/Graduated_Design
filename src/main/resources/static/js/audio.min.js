function initAudioEvent(fileStorageNo,filename){$(".audio-right>p").text(filename),$("#audio-preview").attr("src","/media/preview/"+fileStorageNo),$("#audio-preview").get("0").load();var audio=document.getElementById("audio-preview"),audioPlayer=document.getElementById("audioPlayer");audioPlayer.addEventListener("click",(function(){audio.addEventListener("timeupdate",(function(){updateProgress(audio)}),!1),audio.addEventListener("ended",(function(){audioEnded()}),!1),audio.paused?(audio.play(),audioPlayer.innerHTML='<ion-icon name="pause-circle-outline"></ion-icon>'):(audio.pause(),audioPlayer.innerHTML='<ion-icon name="play-circle-outline"></ion-icon>')}),!1);var progressBarBg=document.getElementById("progressBarBg");progressBarBg.addEventListener("mousedown",(function(event){if(!audio.paused||0!=audio.currentTime){var pgsWidth=parseFloat(window.getComputedStyle(progressBarBg,null).width.replace("px","")),rate=event.offsetX/pgsWidth;audio.currentTime=audio.duration*rate,updateProgress(audio)}}),!1),document.getElementById("audio-close").onclick=function(){audio.pause(),Vue.set(vue.media,"audio",!1),setTimeout(()=>{rightInfoChange(document.getElementsByClassName("right-info")[0])},500)},dragProgressDotEvent(audio),audioPlayer.click()}function dragProgressDotEvent(audio){var dot=document.getElementById("progressDot"),position={oriOffestLeft:0,oriX:0,maxLeft:0,maxRight:0},flag=!1;function down(event){audio.paused&&0==audio.currentTime||(flag=!0,position.oriOffestLeft=dot.offsetLeft,position.oriX=event.touches?event.touches[0].clientX:event.clientX,position.maxLeft=position.oriOffestLeft,position.maxRight=document.getElementById("progressBarBg").offsetWidth-position.oriOffestLeft,event&&event.preventDefault?event.preventDefault():event.returnValue=!1,event&&event.stopPropagation?event.stopPropagation():window.event.cancelBubble=!0)}function move(event){if(flag){var clientX,length=(event.touches?event.touches[0].clientX:event.clientX)-position.oriX;length>position.maxRight?length=position.maxRight:length<-position.maxLeft&&(length=-position.maxLeft);var progressBarBg=document.getElementById("progressBarBg"),pgsWidth=parseFloat(window.getComputedStyle(progressBarBg,null).width.replace("px","")),rate=(position.oriOffestLeft+length)/pgsWidth;audio.currentTime=audio.duration*rate,updateProgress(audio)}}function end(){flag=!1}dot.addEventListener("mousedown",down,!1),dot.addEventListener("touchstart",down,!1),document.addEventListener("mousemove",move,!1),document.addEventListener("touchmove",move,!1),document.addEventListener("mouseup",end,!1),document.addEventListener("touchend",end,!1)}function updateProgress(audio){$(".audio-length-total").get("0").innerHTML=transTime(audio.duration);var value=audio.currentTime/audio.duration;document.getElementById("progressBar").style.width=100*value+"%",document.getElementById("progressDot").style.left=100*value+"%",document.getElementById("audioCurTime").innerText=transTime(audio.currentTime)}function audioEnded(){document.getElementById("progressBar").style.width=0,document.getElementById("progressDot").style.left=0,document.getElementById("audioCurTime").innerText=transTime(0),document.getElementById("audioPlayer").innerHTML='<ion-icon name="play-circle-outline"></ion-icon>'}function transTime(value){var time="",h=parseInt(value/3600);value%=3600;var m=parseInt(value/60),s=parseInt(value%60);return time=formatTime(h>0?h+":"+m+":"+s:m+":"+s)}function formatTime(value){for(var time="",s=value.split(":"),i=0;i<s.length-1;i++)time+=1==s[i].length?"0"+s[i]:s[i],time+=":";return time+=1==s[i].length?"0"+s[i]:s[i]}